import React, { useState, useEffect } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import {
  ShieldCheckIcon,
  ChartBarIcon,
  ClockIcon,
  CogIcon,
  ExclamationTriangleIcon,
  CheckCircleIcon,
  BoltIcon,
  PlayIcon,
  FireIcon,
  DocumentTextIcon,
  ArrowTrendingUpIcon,
  EyeIcon,
  CodeBracketIcon,
  PlusIcon,
  ChatBubbleLeftRightIcon,
  PaperAirplaneIcon,
  XMarkIcon
} from '@heroicons/react/24/outline';

const DashboardPage: React.FC = () => {
  const [activeTab, setActiveTab] = useState('overview');
  const [userName] = useState('Security Expert');
  const [isConfigured, setIsConfigured] = useState(false);
  const [realtimeStats, setRealtimeStats] = useState({
    totalScans: 42,
    vulnerabilities: 18,
    highRisk: 7,
    successRate: 98
  });
  const [showChatbot, setShowChatbot] = useState(false);
  const [chatMessages, setChatMessages] = useState([
    { id: 1, text: 'Hello! I\'m your AI Security Assistant. How can I help you today?', sender: 'bot', timestamp: new Date() }
  ]);
  const [chatInput, setChatInput] = useState('');

  // Optimized: Reduced frequency of real-time updates
  useEffect(() => {
    const interval = setInterval(() => {
      setRealtimeStats(prev => ({
        ...prev,
        totalScans: prev.totalScans + Math.floor(Math.random() * 2),
        vulnerabilities: prev.vulnerabilities + Math.floor(Math.random() * 2)
      }));
    }, 30000); // Changed from 5s to 30s
    return () => clearInterval(interval);
  }, []);

  const tabs = [
    { id: 'overview', name: 'Overview', icon: ChartBarIcon },
    { id: 'scanners', name: 'AI Scanners', icon: ShieldCheckIcon },
    { id: 'reports', name: 'Reports', icon: DocumentTextIcon },
    { id: 'history', name: 'History', icon: ClockIcon },
  ];

  const scanTypes = [
    {
      id: 'prompt-injection',
      title: 'Prompt Injection Scanner',
      description: 'Advanced AI-powered detection of malicious prompt injections and manipulation attempts',
      icon: ShieldCheckIcon,
      color: 'teal',
      gradient: 'from-teal-500/20 via-teal-400/10 to-transparent',
      glowColor: 'teal-400',
      features: ['Real-time Detection', 'Pattern Analysis', 'Threat Intelligence']
    },
    {
      id: 'model-poisoning',
      title: 'Model Poisoning Guard',
      description: 'Comprehensive protection against data poisoning and model manipulation attacks',
      icon: ExclamationTriangleIcon,
      color: 'red',
      gradient: 'from-red-500/20 via-red-400/10 to-transparent',
      glowColor: 'red-400',
      features: ['Data Integrity', 'Model Validation', 'Anomaly Detection']
    },
    {
      id: 'vector-embeddings',
      title: 'Vector Embedding Shield',
      description: 'Secure RAG systems against compromised vector embeddings and similarity attacks',
      icon: EyeIcon,
      color: 'purple',
      gradient: 'from-purple-500/20 via-purple-400/10 to-transparent',
      glowColor: 'purple-400',
      features: ['Embedding Analysis', 'Similarity Checks', 'RAG Protection']
    },
    {
      id: 'code-scanning',
      title: 'AI Code Scanner',
      description: 'Next-generation code analysis with AI-powered vulnerability detection',
      icon: CodeBracketIcon,
      color: 'blue',
      gradient: 'from-blue-500/20 via-blue-400/10 to-transparent',
      glowColor: 'blue-400',
      features: ['Smart Analysis', 'Multi-language', 'Zero-day Detection']
    }
  ];

  const recentScans = [
    { id: 1, name: 'prompt-injection-test.txt', type: 'Prompt Injection', status: 'Completed', result: 'High Risk', date: '2 hours ago', severity: 'critical' },
    { id: 2, name: 'model-training-data.csv', type: 'Model Poisoning', status: 'Completed', result: 'Low Risk', date: '1 day ago', severity: 'low' },
    { id: 3, name: 'vector-database.json', type: 'Vector Embedding', status: 'Completed', result: 'Medium Risk', date: '3 days ago', severity: 'medium' },
    { id: 4, name: 'ai-model-weights.bin', type: 'AI Code Scanner', status: 'Running', result: 'Scanning...', date: 'Just now', severity: 'pending' },
  ];

  const stats = [
    { name: 'Total Scans', value: realtimeStats.totalScans.toString(), icon: ArrowTrendingUpIcon, color: 'teal', change: '+12%' },
    { name: 'Vulnerabilities Found', value: realtimeStats.vulnerabilities.toString(), icon: ExclamationTriangleIcon, color: 'red', change: '+5%' },
    { name: 'High Risk Issues', value: realtimeStats.highRisk.toString(), icon: FireIcon, color: 'orange', change: '-8%' },
    { name: 'Success Rate', value: `${realtimeStats.successRate}%`, icon: CheckCircleIcon, color: 'green', change: '+2%' },
  ];

  const getStatusColor = (result: string, severity?: string) => {
    if (severity === 'critical' || result === 'High Risk') return 'bg-red-500/20 text-red-400 border-red-500/30';
    if (severity === 'medium' || result === 'Medium Risk') return 'bg-yellow-500/20 text-yellow-400 border-yellow-500/30';
    if (severity === 'low' || result === 'Low Risk') return 'bg-green-500/20 text-green-400 border-green-500/30';
    if (severity === 'pending' || result === 'Scanning...') return 'bg-blue-500/20 text-blue-400 border-blue-500/30';
    return 'bg-gray-500/20 text-gray-400 border-gray-500/30';
  };

  const handleChatSubmit = (e: React.FormEvent) => {
    e.preventDefault();
    if (!chatInput.trim()) return;

    const userMessage = {
      id: Date.now(),
      text: chatInput,
      sender: 'user' as const,
      timestamp: new Date()
    };

    setChatMessages(prev => [...prev, userMessage]);
    setChatInput('');

    // Simulate AI response
    setTimeout(() => {
      const botResponse = {
        id: Date.now() + 1,
        text: getBotResponse(chatInput),
        sender: 'bot' as const,
        timestamp: new Date()
      };
      setChatMessages(prev => [...prev, botResponse]);
    }, 1000);
  };

  const getBotResponse = (input: string): string => {
    const lowerInput = input.toLowerCase();
    if (lowerInput.includes('scan') || lowerInput.includes('security')) {
      return 'I can help you with security scans! You can start a new scan from the AI Security Scanners section. Which type of scan would you like to run?';
    }
    if (lowerInput.includes('vulnerability') || lowerInput.includes('threat')) {
      return 'Based on your recent scans, I see you have some vulnerabilities to address. Would you like me to help you prioritize them or explain the findings?';
    }
    if (lowerInput.includes('dashboard') || lowerInput.includes('help')) {
      return 'This dashboard shows your security overview, recent scans, and AI scanner tools. You can configure AI models, view reports, and start new scans. What would you like to know more about?';
    }
    if (lowerInput.includes('model') || lowerInput.includes('config')) {
      return 'I can help you configure your AI models for better security scanning. Click the "Configure AI Models" button to get started with model setup.';
    }
    return 'I\'m here to help with your AI security needs! You can ask me about scans, vulnerabilities, dashboard features, or model configuration.';
  };

  return (
    <div className="min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 relative overflow-hidden">
      {/* Animated Background */}
      <div className="absolute inset-0 overflow-hidden">
        {Array.from({ length: 30 }).map((_, i) => {
          const size = [2, 3, 4][Math.floor(Math.random() * 3)];
          const animationDuration = [3, 4, 5][Math.floor(Math.random() * 3)];
          const delay = Math.random() * 5;
          const x = Math.random() * 100;
          const y = Math.random() * 100;
          
          return (
            <div
              key={i}
              className={`absolute rounded-full animate-pulse`}
              style={{
                width: `${size}px`,
                height: `${size}px`,
                left: `${x}%`,
                top: `${y}%`,
                animationDelay: `${delay}s`,
                animationDuration: `${animationDuration}s`,
                background: 'radial-gradient(circle, rgba(20, 184, 166, 0.4) 0%, rgba(20, 184, 166, 0.1) 100%)',
                boxShadow: `0 0 ${size * 3}px rgba(20, 184, 166, 0.3)`,
              }}
            />
          );
        })}
      </div>

      <div className="relative z-10 mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-8">
        {/* Header */}
        <motion.div 
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ duration: 0.6 }}
          className="mb-8"
        >
          <div className="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6">
            <div>
              <h1 className="text-4xl sm:text-5xl font-bold bg-gradient-to-r from-teal-400 via-blue-400 to-purple-400 bg-clip-text text-transparent mb-2">
                Welcome back, <span className="text-teal-400">{userName}</span>
              </h1>
              <p className="text-gray-300 text-lg">Advanced AI Security Dashboard - Protect your systems with cutting-edge technology</p>
            </div>
            <motion.button 
              onClick={() => setIsConfigured(!isConfigured)}
              className="mt-4 sm:mt-0 flex items-center space-x-2 bg-gradient-to-r from-teal-500 to-blue-500 hover:from-teal-600 hover:to-blue-600 text-white px-6 py-3 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-teal-500/25"
              whileHover={{ scale: 1.05 }}
              whileTap={{ scale: 0.95 }}
            >
              <CogIcon className="h-5 w-5" />
              <span>Configure AI Models</span>
            </motion.button>
          </div>
        </motion.div>

        {/* Enhanced Tabs */}
        <motion.div 
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ duration: 0.6, delay: 0.1 }}
          className="mb-8"
        >
          <div className="bg-gray-800/50 backdrop-blur-sm rounded-2xl p-2 border border-gray-700/50">
            <nav className="flex space-x-2">
              {tabs.map((tab) => (
                <motion.button
                  key={tab.id}
                  onClick={() => setActiveTab(tab.id)}
                  className={`${
                    activeTab === tab.id
                      ? 'bg-gradient-to-r from-teal-500 to-blue-500 text-white shadow-lg'
                      : 'text-gray-400 hover:text-white hover:bg-gray-700/50'
                  } flex items-center space-x-2 px-6 py-3 rounded-xl font-medium text-sm transition-all duration-300 flex-1 justify-center`}
                  whileHover={{ scale: 1.02 }}
                  whileTap={{ scale: 0.98 }}
                >
                  <tab.icon className="h-5 w-5" />
                  <span className="hidden sm:inline">{tab.name}</span>
                </motion.button>
              ))}
            </nav>
          </div>
        </motion.div>

        {/* Enhanced Stats Cards */}
        <motion.div 
          initial={{ opacity: 0 }}
          animate={{ opacity: 1 }}
          transition={{ duration: 0.6, delay: 0.2 }}
          className="mb-8"
        >
          <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
            {stats.map((stat, index) => {
              const IconComponent = stat.icon;
              return (
                <motion.div
                  key={stat.name}
                  initial={{ opacity: 0, y: 30 }}
                  animate={{ opacity: 1, y: 0 }}
                  transition={{ duration: 0.6, delay: 0.1 * index }}
                  className={`relative group overflow-hidden rounded-2xl bg-gradient-to-br from-gray-800/80 to-gray-900/80 backdrop-blur-sm border border-gray-700/50 p-6 hover:border-${stat.color}-500/50 transition-all duration-300 hover:shadow-lg hover:shadow-${stat.color}-500/10`}
                  whileHover={{ scale: 1.02, y: -2 }}
                >
                  <div className={`absolute inset-0 bg-gradient-to-br from-${stat.color}-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300`} />
                  <div className="relative z-10">
                    <div className="flex items-center justify-between mb-4">
                      <div className={`p-3 bg-${stat.color}-500/20 rounded-xl group-hover:bg-${stat.color}-500/30 transition-colors duration-300`}>
                        <IconComponent className={`h-6 w-6 text-${stat.color}-400`} />
                      </div>
                      <div className={`text-sm font-medium px-2 py-1 rounded-lg bg-${stat.color}-500/20 text-${stat.color}-400`}>
                        {stat.change}
                      </div>
                    </div>
                    <div className="text-3xl font-bold text-white mb-1">{stat.value}</div>
                    <div className="text-gray-400 text-sm">{stat.name}</div>
                  </div>
                  <div className={`absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r from-${stat.color}-500 to-${stat.color}-400 transform scale-x-0 group-hover:scale-x-100 transition-transform duration-300`} />
                </motion.div>
              );
            })}
          </div>
        </motion.div>

        <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
          {/* AI Scanner Cards */}
          <div className="lg:col-span-2">
            <motion.div
              initial={{ opacity: 0, y: 20 }}
              animate={{ opacity: 1, y: 0 }}
              transition={{ duration: 0.6, delay: 0.3 }}
            >
              <h2 className="text-2xl font-bold text-white mb-6 flex items-center space-x-2">
                <BoltIcon className="h-7 w-7 text-teal-400" />
                <span>AI Security Scanners</span>
              </h2>
              <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                {scanTypes.map((scanner, index) => {
                  const IconComponent = scanner.icon;
                  return (
                    <motion.div
                      key={scanner.id}
                      initial={{ opacity: 0, y: 30 }}
                      animate={{ opacity: 1, y: 0 }}
                      transition={{ duration: 0.6, delay: 0.1 * index }}
                      className={`relative group cursor-pointer overflow-hidden rounded-2xl bg-gradient-to-br ${scanner.gradient} backdrop-blur-sm border border-gray-700/50 hover:border-${scanner.color}-500/50 transition-all duration-300 hover:shadow-xl hover:shadow-${scanner.glowColor}/20`}
                      whileHover={{ scale: 1.02, y: -5 }}
                      whileTap={{ scale: 0.98 }}
                    >
                      {/* Glow Effect */}
                      <div className={`absolute inset-0 bg-gradient-to-br from-${scanner.color}-500/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300`} />
                      
                      <div className="relative p-6">
                        {/* Icon */}
                        <div className={`inline-flex items-center justify-center w-14 h-14 bg-${scanner.color}-500/20 rounded-xl mb-4 group-hover:bg-${scanner.color}-500/30 transition-colors duration-300 group-hover:scale-110`}>
                          <IconComponent className={`h-7 w-7 text-${scanner.color}-400`} />
                        </div>

                        {/* Content */}
                        <h3 className="text-xl font-bold text-white mb-2 group-hover:text-teal-400 transition-colors duration-300">
                          {scanner.title}
                        </h3>
                        <p className="text-gray-400 text-sm leading-relaxed mb-4">{scanner.description}</p>

                        {/* Features */}
                        <div className="flex flex-wrap gap-2 mb-4">
                          {scanner.features.map((feature, idx) => (
                            <span key={idx} className={`text-xs px-2 py-1 rounded-lg bg-${scanner.color}-500/20 text-${scanner.color}-400 border border-${scanner.color}-500/30`}>
                              {feature}
                            </span>
                          ))}
                        </div>

                        {/* Action Button */}
                        <div className="flex items-center justify-between">
                          <div className="flex items-center space-x-2">
                            {isConfigured ? (
                              <div className="flex items-center space-x-1 text-green-400 text-sm">
                                <CheckCircleIcon className="h-4 w-4" />
                                <span>Ready to Scan</span>
                              </div>
                            ) : (
                              <div className="flex items-center space-x-1 text-yellow-400 text-sm">
                                <CogIcon className="h-4 w-4" />
                                <span>Setup Required</span>
                              </div>
                            )}
                          </div>
                          <motion.div 
                            className={`p-2 rounded-lg bg-${scanner.color}-500/20 text-${scanner.color}-400 group-hover:bg-${scanner.color}-500/30 transition-colors duration-300`}
                            whileHover={{ rotate: 90 }}
                          >
                            <PlayIcon className="h-5 w-5" />
                          </motion.div>
                        </div>

                        {/* Hover Border Glow */}
                        <div className={`absolute inset-0 border-2 border-${scanner.color}-500/50 opacity-0 group-hover:opacity-100 rounded-2xl transition-opacity duration-300`} />
                      </div>
                    </motion.div>
                  );
                })}
              </div>
            </motion.div>
          </div>

          {/* Enhanced Sidebar */}
          <div className="space-y-6">
            {/* Configuration Status */}
            <motion.div
              initial={{ opacity: 0, x: 20 }}
              animate={{ opacity: 1, x: 0 }}
              transition={{ duration: 0.6, delay: 0.4 }}
              className="bg-gradient-to-br from-gray-800/80 to-gray-900/80 backdrop-blur-sm rounded-2xl p-6 border border-gray-700/50 hover:border-teal-500/30 transition-all duration-300"
            >
              <h3 className="text-lg font-bold text-white mb-4 flex items-center space-x-2">
                <CogIcon className="h-5 w-5 text-teal-400" />
                <span>AI Model Status</span>
              </h3>
              {isConfigured ? (
                <div className="space-y-4">
                  <div className="flex items-center space-x-2 text-green-400">
                    <CheckCircleIcon className="h-5 w-5" />
                    <span className="text-sm font-medium">Models Configured</span>
                  </div>
                  <div className="space-y-2 text-sm text-gray-400">
                    <div className="flex justify-between">
                      <span>Primary Model:</span>
                      <span className="text-white">GPT-4 Turbo</span>
                    </div>
                    <div className="flex justify-between">
                      <span>Security Level:</span>
                      <span className="text-green-400">Maximum</span>
                    </div>
                    <div className="flex justify-between">
                      <span>API Status:</span>
                      <span className="text-green-400">Connected</span>
                    </div>
                  </div>
                  <motion.button
                    className="w-full bg-gradient-to-r from-teal-500 to-blue-500 hover:from-teal-600 hover:to-blue-600 text-white py-2 px-4 rounded-lg text-sm font-medium transition-all duration-300"
                    whileHover={{ scale: 1.02 }}
                    whileTap={{ scale: 0.98 }}
                  >
                    Update Configuration
                  </motion.button>
                </div>
              ) : (
                <div className="space-y-4">
                  <div className="flex items-center space-x-2 text-yellow-400">
                    <ExclamationTriangleIcon className="h-5 w-5" />
                    <span className="text-sm font-medium">Configuration Required</span>
                  </div>
                  <p className="text-sm text-gray-400">Configure your AI models to start advanced security scanning</p>
                  <motion.button
                    onClick={() => setIsConfigured(true)}
                    className="w-full bg-gradient-to-r from-yellow-500 to-orange-500 hover:from-yellow-600 hover:to-orange-600 text-white py-2 px-4 rounded-lg text-sm font-medium transition-all duration-300"
                    whileHover={{ scale: 1.02 }}
                    whileTap={{ scale: 0.98 }}
                  >
                    Configure Now
                  </motion.button>
                </div>
              )}
            </motion.div>

            {/* Recent Scans */}
            <motion.div
              initial={{ opacity: 0, x: 20 }}
              animate={{ opacity: 1, x: 0 }}
              transition={{ duration: 0.6, delay: 0.5 }}
              className="bg-gradient-to-br from-gray-800/80 to-gray-900/80 backdrop-blur-sm rounded-2xl p-6 border border-gray-700/50 hover:border-purple-500/30 transition-all duration-300"
            >
              <h3 className="text-lg font-bold text-white mb-4 flex items-center space-x-2">
                <ClockIcon className="h-5 w-5 text-purple-400" />
                <span>Recent Activity</span>
              </h3>
              <div className="space-y-3">
                {recentScans.map((scan, index) => (
                  <motion.div 
                    key={scan.id}
                    initial={{ opacity: 0, x: -10 }}
                    animate={{ opacity: 1, x: 0 }}
                    transition={{ duration: 0.3, delay: index * 0.1 }}
                    className="flex items-center justify-between p-3 bg-gray-700/30 rounded-xl hover:bg-gray-700/50 transition-colors duration-300 group cursor-pointer"
                    whileHover={{ x: 5 }}
                  >
                    <div className="flex-1 min-w-0">
                      <p className="text-sm font-medium text-white truncate group-hover:text-teal-400 transition-colors duration-300">
                        {scan.name}
                      </p>
                      <p className="text-xs text-gray-400">{scan.type} â€¢ {scan.date}</p>
                    </div>
                    <div className={`px-2 py-1 rounded-lg text-xs font-medium border ${getStatusColor(scan.result, scan.severity)}`}>
                      {scan.result}
                    </div>
                  </motion.div>
                ))}
              </div>
              <motion.button
                className="w-full mt-4 text-center text-sm text-gray-400 hover:text-white transition-colors duration-300 py-2 border border-gray-700 rounded-lg hover:border-gray-600"
                whileHover={{ scale: 1.02 }}
              >
                View All Scans
              </motion.button>
            </motion.div>

            {/* Quick Actions */}
            <motion.div
              initial={{ opacity: 0, x: 20 }}
              animate={{ opacity: 1, x: 0 }}
              transition={{ duration: 0.6, delay: 0.6 }}
              className="bg-gradient-to-br from-gray-800/80 to-gray-900/80 backdrop-blur-sm rounded-2xl p-6 border border-gray-700/50 hover:border-blue-500/30 transition-all duration-300"
            >
              <h3 className="text-lg font-bold text-white mb-4 flex items-center space-x-2">
                <BoltIcon className="h-5 w-5 text-blue-400" />
                <span>Quick Actions</span>
              </h3>
              <div className="space-y-3">
                {[
                  { name: 'Emergency Scan', icon: FireIcon, color: 'red' },
                  { name: 'Generate Report', icon: DocumentTextIcon, color: 'blue' },
                  { name: 'Schedule Scan', icon: ClockIcon, color: 'green' },
                  { name: 'Export Data', icon: ArrowTrendingUpIcon, color: 'purple' }
                ].map((action, index) => {
                  const ActionIcon = action.icon;
                  return (
                    <motion.button
                      key={action.name}
                      className={`w-full flex items-center space-x-3 p-3 bg-gray-700/30 rounded-xl hover:bg-${action.color}-500/20 hover:border-${action.color}-500/30 border border-transparent transition-all duration-300 text-left group`}
                      whileHover={{ scale: 1.02, x: 5 }}
                      whileTap={{ scale: 0.98 }}
                    >
                      <div className={`p-2 bg-${action.color}-500/20 rounded-lg group-hover:bg-${action.color}-500/30 transition-colors duration-300`}>
                        <ActionIcon className={`h-4 w-4 text-${action.color}-400`} />
                      </div>
                      <span className="text-sm text-gray-300 group-hover:text-white transition-colors duration-300">
                        {action.name}
                      </span>
                    </motion.button>
                  );
                })}
              </div>
            </motion.div>

            {/* AI Assistant Chatbot */}
            <motion.div
              initial={{ opacity: 0, x: 20 }}
              animate={{ opacity: 1, x: 0 }}
              transition={{ duration: 0.6, delay: 0.7 }}
              className="bg-gradient-to-br from-gray-800/80 to-gray-900/80 backdrop-blur-sm rounded-2xl p-6 border border-gray-700/50 hover:border-teal-500/30 transition-all duration-300"
            >
              <div className="flex items-center justify-between mb-4">
                <h3 className="text-lg font-bold text-white flex items-center space-x-2">
                  <ChatBubbleLeftRightIcon className="h-5 w-5 text-teal-400" />
                  <span>AI Security Assistant</span>
                </h3>
                <motion.button
                  onClick={() => setShowChatbot(!showChatbot)}
                  className="p-2 bg-teal-500/20 hover:bg-teal-500/30 rounded-lg transition-colors duration-300"
                  whileHover={{ scale: 1.05 }}
                  whileTap={{ scale: 0.95 }}
                >
                  {showChatbot ? (
                    <XMarkIcon className="h-4 w-4 text-teal-400" />
                  ) : (
                    <ChatBubbleLeftRightIcon className="h-4 w-4 text-teal-400" />
                  )}
                </motion.button>
              </div>
              
              <AnimatePresence>
                {showChatbot && (
                  <motion.div
                    initial={{ opacity: 0, height: 0 }}
                    animate={{ opacity: 1, height: 'auto' }}
                    exit={{ opacity: 0, height: 0 }}
                    transition={{ duration: 0.3 }}
                    className="space-y-4"
                  >
                    {/* Chat Messages */}
                    <div className="h-64 overflow-y-auto space-y-3 bg-gray-900/50 rounded-lg p-4 border border-gray-700/30">
                      {chatMessages.map((message) => (
                        <motion.div
                          key={message.id}
                          initial={{ opacity: 0, y: 10 }}
                          animate={{ opacity: 1, y: 0 }}
                          className={`flex ${message.sender === 'user' ? 'justify-end' : 'justify-start'}`}
                        >
                          <div className={`max-w-xs px-3 py-2 rounded-lg text-sm ${
                            message.sender === 'user'
                              ? 'bg-teal-500 text-white'
                              : 'bg-gray-700 text-gray-200'
                          }`}>
                            {message.text}
                          </div>
                        </motion.div>
                      ))}
                    </div>
                    
                    {/* Chat Input */}
                    <form onSubmit={handleChatSubmit} className="flex space-x-2">
                      <input
                        type="text"
                        value={chatInput}
                        onChange={(e) => setChatInput(e.target.value)}
                        placeholder="Ask about security scans, vulnerabilities..."
                        className="flex-1 bg-gray-700/50 border border-gray-600 rounded-lg px-3 py-2 text-white text-sm placeholder-gray-400 focus:outline-none focus:border-teal-500 transition-colors duration-300"
                      />
                      <motion.button
                        type="submit"
                        className="p-2 bg-teal-500 hover:bg-teal-600 rounded-lg transition-colors duration-300"
                        whileHover={{ scale: 1.05 }}
                        whileTap={{ scale: 0.95 }}
                      >
                        <PaperAirplaneIcon className="h-4 w-4 text-white" />
                      </motion.button>
                    </form>
                  </motion.div>
                )}
              </AnimatePresence>
              
              {!showChatbot && (
                <div className="text-center">
                  <p className="text-sm text-gray-400 mb-3">Get instant help with security questions</p>
                  <motion.button
                    onClick={() => setShowChatbot(true)}
                    className="w-full bg-gradient-to-r from-teal-500 to-blue-500 hover:from-teal-600 hover:to-blue-600 text-white py-2 px-4 rounded-lg text-sm font-medium transition-all duration-300"
                    whileHover={{ scale: 1.02 }}
                    whileTap={{ scale: 0.98 }}
                  >
                    Start Chat
                  </motion.button>
                </div>
              )}
            </motion.div>
          </div>
        </div>

        {/* Recent Scans Table */}
        <motion.div
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ duration: 0.6, delay: 0.7 }}
          className="mt-8 bg-gradient-to-br from-gray-800/80 to-gray-900/80 backdrop-blur-sm rounded-2xl border border-gray-700/50 overflow-hidden"
        >
          <div className="p-6 border-b border-gray-700/50">
            <h2 className="text-2xl font-bold text-white flex items-center space-x-2">
              <DocumentTextIcon className="h-7 w-7 text-blue-400" />
              <span>Recent Scan Results</span>
            </h2>
          </div>
          <div className="overflow-x-auto">
            <table className="min-w-full divide-y divide-gray-700/50">
              <thead className="bg-gray-800/50">
                <tr>
                  <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider">File</th>
                  <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider">Scanner Type</th>
                  <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider">Status</th>
                  <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider">Result</th>
                  <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider">Date</th>
                </tr>
              </thead>
              <tbody className="bg-gray-800/30 divide-y divide-gray-700/50">
                {recentScans.map((scan) => (
                  <tr key={scan.id} className="hover:bg-gray-700/30 transition-colors duration-150">
                    <td className="px-6 py-4 whitespace-nowrap text-sm font-medium text-white">{scan.name}</td>
                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-300">{scan.type}</td>
                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-300">{scan.status}</td>
                    <td className="px-6 py-4 whitespace-nowrap">
                      <span className={`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full border ${getStatusColor(scan.result, scan.severity)}`}>
                        {scan.result}
                      </span>
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-300">{scan.date}</td>
                  </tr>
                ))}
              </tbody>
            </table>
          </div>
          <div className="px-6 py-4 border-t border-gray-700/50">
            <button className="text-sm font-medium text-teal-400 hover:text-teal-300 transition-colors duration-150">View all scans</button>
          </div>
        </motion.div>

        {/* Upload New Scan */}
        <motion.div 
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ duration: 0.6, delay: 0.8 }}
          className="mt-8 bg-gradient-to-br from-gray-800/80 to-gray-900/80 backdrop-blur-sm rounded-2xl p-6 border border-gray-700/50"
        >
          <h3 className="text-2xl font-bold text-white mb-6 flex items-center space-x-2">
            <PlusIcon className="h-7 w-7 text-green-400" />
            <span>Start a New Scan</span>
          </h3>
          <div className="grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4">
            {scanTypes.map((scanner, index) => {
              const IconComponent = scanner.icon;
              return (
                <motion.div
                  key={scanner.id}
                  initial={{ opacity: 0, y: 20 }}
                  animate={{ opacity: 1, y: 0 }}
                  transition={{ duration: 0.4, delay: 0.1 * index }}
                  className={`relative group cursor-pointer overflow-hidden rounded-xl bg-gradient-to-br ${scanner.gradient} backdrop-blur-sm border border-gray-700/50 hover:border-${scanner.color}-500/50 p-4 transition-all duration-300 hover:shadow-lg hover:shadow-${scanner.glowColor}/20`}
                  whileHover={{ scale: 1.02, y: -2 }}
                  whileTap={{ scale: 0.98 }}
                >
                  <div className={`flex items-center justify-center h-12 w-12 rounded-lg bg-${scanner.color}-500/20 text-${scanner.color}-400 mb-4 group-hover:bg-${scanner.color}-500/30 transition-colors duration-300`}>
                    <IconComponent className="h-6 w-6" />
                  </div>
                  <h4 className="text-lg font-semibold text-white mb-2 group-hover:text-teal-400 transition-colors duration-300">{scanner.title}</h4>
                  <p className="text-sm text-gray-400 leading-relaxed">{scanner.description}</p>
                  <div className={`absolute inset-0 border-2 border-${scanner.color}-500/50 opacity-0 group-hover:opacity-100 rounded-xl transition-opacity duration-300`} />
                </motion.div>
              );
            })}
          </div>
        </motion.div>
      </div>
    </div>
  );
};

export default DashboardPage;